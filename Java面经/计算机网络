## TCP三次握手和四次挥手

### 图解

![TCP三次握手](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019/7/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png)

- 客户端-带有SYN标志的数据包-一次握手-服务端
- 服务端-带有SYN/ACK标志的数据包-二次握手-客户端
- 客户端-带有ACK标志的数据包-三次握手-服务端

### 为什么三次握手

第一次握手，Client什么都不能确认，Server确认Client发送正常，Server接收正常

第二次握手，Client确认自己的发送正常，接收正常，Server的发送，接收正常

但是Server不知道自己的发送是不是正常，对方的接收是不是正常

第三次握手：Client 确认了：自己发送、接收正常，对方发送、接收正常；Server 确认了：自己发送、接收正常，对方发送、接收正常

### 2.3 第二次握手传ACK，为什么还要传SYN

ACK传回就是告诉客户端，收到客户端发送的信号

SYN是为了**建立并确认从服务端到客户端的通信**

### 为什么要四次挥手

![TCP四次挥手](https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019/7/TCP%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png)

断开一个TCP连接需要四次挥手

- 客户端发送FIN，关闭客户端到服务端的数据传送
- 服务端接收FIN，发送一个ACK，确认序号为接收序号+1，和SYN一样
- 服务端-关闭与客户端的连接，发送FIN到客户端
- 客户端：发送ACK报文段确认，确认序号为接收序号+1